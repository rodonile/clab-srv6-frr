name: frr-srv6
prefix: ""

topology:
  nodes:
    # CORE ROUTERS (ISIS-DOMAIN)
    frr1:
      kind: linux
      image: quay.io/frrouting/frr:10.2.3
      binds:
        - frr1/daemons:/etc/frr/daemons
        - frr1/frr.conf:/etc/frr/frr.conf

    frr2:
      kind: linux
      image: quay.io/frrouting/frr:10.2.3
      binds:
        - frr2/daemons:/etc/frr/daemons
        - frr2/frr.conf:/etc/frr/frr.conf

    frr3:
      kind: linux
      image: quay.io/frrouting/frr:10.2.3
      binds:
        - frr3/daemons:/etc/frr/daemons
        - frr3/frr.conf:/etc/frr/frr.conf

    frr4:
      kind: linux
      image: quay.io/frrouting/frr:10.2.3
      binds:
        - frr3/daemons:/etc/frr/daemons
        - frr3/frr.conf:/etc/frr/frr.conf

    frr5:
      kind: linux
      image: quay.io/frrouting/frr:10.2.3
      binds:
        - frr3/daemons:/etc/frr/daemons
        - frr3/frr.conf:/etc/frr/frr.conf

    frr6:
      kind: linux
      image: quay.io/frrouting/frr:10.2.3
      binds:
        - frr3/daemons:/etc/frr/daemons
        - frr3/frr.conf:/etc/frr/frr.conf

    # CE ROUTERS (CLIENT 1)
    frr_c1_r1:
      kind: linux
      image: quay.io/frrouting/frr:10.2.3
      binds:
        - frr_c1_r1/daemons:/etc/frr/daemons
        - frr_c1_r1/frr.conf:/etc/frr/frr.conf

    frr_c1_r2:
      kind: linux
      image: quay.io/frrouting/frr:10.2.3
      binds:
        - frr_c1_r2/daemons:/etc/frr/daemons
        - frr_c1_r2/frr.conf:/etc/frr/frr.conf

    # CE ROUTERS (CLIENT 2)
    frr_c2_r1:
      kind: linux
      image: quay.io/frrouting/frr:10.2.3
      binds:
        - frr_c2_r1/daemons:/etc/frr/daemons
        - frr_c2_r1/frr.conf:/etc/frr/frr.conf

    frr_c2_r2:
      kind: linux
      image: quay.io/frrouting/frr:10.2.3
      binds:
        - frr_c2_r2/daemons:/etc/frr/daemons
        - frr_c2_r2/frr.conf:/etc/frr/frr.conf

    PC11:
      kind: linux
      image: network-multitool-leo:v1.0
      exec:
        - ip link set eth1 up
        - ip addr add 192.168.11.2/24 dev eth1
        - ip -6 addr add c1:1:feed::2/64 dev eth1
        - ip route add 192.168.0.0/16 via 192.168.11.1 dev eth1
    PC12:
      kind: linux
      image: network-multitool-leo:v1.0
      exec:
        - ip link set eth1 up
        - ip addr add 192.168.12.2/24 dev eth1
        - ip -6 addr add c1:2:feed::2/64 dev eth1
        - ip route add 192.168.0.0/16 via 192.168.12.1 dev eth1

    PC21:
      kind: linux
      image: network-multitool-leo:v1.0
      exec:
        - ip link set eth1 up
        - ip addr add 192.168.21.2/24 dev eth1
        - ip -6 addr add c2:1:feed::2/64 dev eth1
        - ip route add 192.168.0.0/16 via 192.168.21.1 dev eth1

    PC22:
      kind: linux
      image: network-multitool-leo:v1.0
      exec:
        - ip link set eth1 up
        - ip addr add 192.168.22.2/24 dev eth1
        - ip -6 addr add c2:2:feed::2/64 dev eth1
        - ip route add 192.168.0.0/16 via 192.168.22.1 dev eth1

  links:
    - endpoints: [ "frr_c1_r1:eth1", "frr3:eth3" ]
    - endpoints: [ "frr_c2_r1:eth1", "frr3:eth4" ]
    - endpoints: [ "frr3:eth2", "frr1:eth3" ]
    - endpoints: [ "frr3:eth1", "frr4:eth1" ]
    - endpoints: [ "frr1:eth1", "frr2:eth1" ]
    - endpoints: [ "frr1:eth2", "frr5:eth2" ]
    - endpoints: [ "frr4:eth2", "frr5:eth3" ]
    - endpoints: [ "frr2:eth2", "frr6:eth2" ]
    - endpoints: [ "frr5:eth1", "frr6:eth1" ]
    - endpoints: [ "frr6:eth3", "frr_c1_r2:eth1" ]
    - endpoints: [ "frr6:eth4", "frr_c2_r2:eth1" ]
    - endpoints: [ "frr_c1_r1:eth2", "PC11:eth1" ]
    - endpoints: [ "frr_c1_r2:eth2", "PC12:eth1" ]
    - endpoints: [ "frr_c2_r1:eth2", "PC21:eth1" ]
    - endpoints: [ "frr_c2_r2:eth2", "PC22:eth1" ]
